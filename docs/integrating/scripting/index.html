<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/birt-website/blog/rss.xml" title="BIRT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/birt-website/blog/atom.xml" title="BIRT Atom Feed"><title data-react-helmet="true">Scripting | BIRT</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://eclipse.github.io//birt-website/docs/integrating/scripting"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Scripting | BIRT"><meta data-react-helmet="true" name="description" content="Background"><meta data-react-helmet="true" property="og:description" content="Background"><link data-react-helmet="true" rel="shortcut icon" href="/birt-website/img/BIRT-Icon.ico/"><link data-react-helmet="true" rel="canonical" href="https://eclipse.github.io//birt-website/docs/integrating/scripting"><link data-react-helmet="true" rel="alternate" href="https://eclipse.github.io//birt-website/docs/integrating/scripting" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://eclipse.github.io//birt-website/docs/integrating/scripting" hreflang="x-default"><link rel="stylesheet" href="/birt-website/assets/css/styles.17108370.css">
<link rel="preload" href="/birt-website/assets/js/runtime~main.41b33e74.js" as="script">
<link rel="preload" href="/birt-website/assets/js/main.34593de7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/birt-website/"><div class="navbar__logo"><img src="/birt-website/img/BIRT-03.png" alt="BIRT" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/birt-website/img/BIRT-03.png" alt="BIRT" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">HOME</b></a><a class="navbar__item navbar__link" href="/birt-website/docs/what-is-birt">About</a><a class="navbar__item navbar__link" href="/birt-website/docs/installation">Get started</a><a class="navbar__item navbar__link" href="/birt-website/docs/t_brief-editor-tour">Documentation</a><a class="navbar__item navbar__link" href="/birt-website/docs/integrating/integrating">Integrating</a><a class="navbar__item navbar__link" href="/birt-website/docs/template-introduction">Templates</a><a class="navbar__item navbar__link" href="/birt-website/docs/gallery">Gallery</a><a class="navbar__item navbar__link" href="/birt-website/docs/community">Community</a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Scripting</h1></header><h3 class="anchor anchorWithStickyNavbar_y2LR" id="background">Background<a aria-hidden="true" class="hash-link" href="#background" title="Direct link to heading">â€‹</a></h3><p>BIRT provides a rich scripting model based on the Mozilla Rhino engine. The processes that the Report engine uses to create reports can be classified in two phases, Report Generation and Presentation. The Generation phase consumes the report design and creates an intermediate file, called the report document. The Presentation phase uses the report document to render to HTML or PDF. The report creation pipeline can execute these phases as one task or in two tasks. If executed in one phase the report document is created in memory. This is the default behavior of the designer when &quot;Preview as HTML&quot; is chosen. If executed in two phases the report document is created and stored to disk. This is the default behavior of the designer when &quot;Preview in Web Viewer&quot; is selected.</p><p>Events within each phase can be overridden, by creating event handlers, to alter report content. BIRT allows these event handlers to be written in either JavaScript or Java. If you code your event handler in both Java and JavaScript the JavaScript version will be executed by default.</p><p><img alt="img" src="/birt-website/assets/images/overview-6f612482655c5568c26a05d1e22f7588.jpg"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="events">Events<a aria-hidden="true" class="hash-link" href="#events" title="Direct link to heading">â€‹</a></h3><p>Script events are defined for three objects, Report Object, Report Elements, and Data Source(Sets). The phase the engine is processing determines what events and which properties of the object are available for customization. The diagram below illustrates what Script Events are available in a particular phase, for a given object.</p><p>Pictured below is a representation of the event firing order for a simple report containing a table and a data element. The event order is shown for separate generation and presentation phases.</p><p><img alt="img" src="/birt-website/assets/images/events-9fe9fc822708efd359decf32d8c6ba34.jpg"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="generation-phase">Generation phase.<a aria-hidden="true" class="hash-link" href="#generation-phase" title="Direct link to heading">â€‹</a></h3><p><img alt="img" src="/birt-website/assets/images/eventgen-b246e6cc87e75308d9464ac55ab3a293.jpg"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="presentation-phase">Presentation phase.<a aria-hidden="true" class="hash-link" href="#presentation-phase" title="Direct link to heading">â€‹</a></h3><p><img alt="img" src="/birt-website/assets/images/eventpres-eaa4253031f066137cd8b14305b9017f.jpg"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="reportcontext-and-this">reportContext and <em>this</em><a aria-hidden="true" class="hash-link" href="#reportcontext-and-this" title="Direct link to heading">â€‹</a></h3><p>Selecting the Palette view while in the Script editor will display functions and variables that are available in the given event for the selected report element. For example the screenshot below is for the <strong>onCreate</strong> event handler of a data element.</p><p><img alt="img" src="/birt-website/assets/images/palette-0ae18265dfd60bb0ecc6419463bd9280.jpg"></p><p>Using the <em>this</em> operator list available methods and properties for the element in the given event and is used to view or alter styles, values etc. See examples illustrated later.</p><p>Use of reportContext allows accessing or modifying of report wide properties. Using reportContext a developer can set global variables to share between elements. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                onInitialize of the report</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reportContext.setPersistentGlobalVariable(&quot;testglobal&quot;, &quot;test global string&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>use of the Persistent version allows the variable to be persisted across generation and presentation. Also note that the variable is an Object type allowing greater flexibility.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                onPrepare of a label element in a table</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.text = reportContext.getPersistentGlobalVariable(&#x27;testglobal&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This global variable can be assigned to a data element using the binding editor. Simply reference the variable in the expression builder for the desired column. For example, if a column exist in the binding editor that retrieves a string from a data base, you could append your global variable to the value by entering the following expression:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                dataSetRow[&quot;MyString&quot;] + &quot;-&quot; + reportContext</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     .getPersistentGlobalVariable(&#x27;testglobal&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The reportContext also allows access to session variables.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                //attributeBean is a Birt Viewer supplied session variable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myAttributeBean = reportContext.getHttpServletRequest()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     .getAttribute(&#x27;attributeBean&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reportDoc = myAttributeBean.getReportDocumentName( );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.text = reportDoc;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The reportContext allows reading and modifying the context for use within scripts. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                onInitialize of the report</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                appContext = reportContext.getAppContext();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                importPackage(Packages.java.util)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myArrList = new ArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myArrList.add(&quot;one&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myArrList.add(&quot;two&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                appContext.put(&quot;AppContextTest&quot;, myArrList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This loads the current application context and modifies it for later use. Within a label element&#x27;s onPrepare event handler, it could then be used as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                appContext = reportContext.getAppContext();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myObject = appContext.get(&quot;AppContextTest&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.text = myObject.size();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The above example could have also been implemented using:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reportContext.setPersistentGlobalVariable(&quot;testglobal&quot;, myArrList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The reportContext can also be used to retrieve the current locale and messages stored within a resource file.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="report-level-events">Report Level Events<a aria-hidden="true" class="hash-link" href="#report-level-events" title="Direct link to heading">â€‹</a></h3><ul><li><p>afterFactory - The afterFactory event executes upon terminating the generation phase.</p></li><li><p>afterRender - The afterRender event executes at the end of the presentation phase.</p></li><li><p>beforeFactory - The beforeFactory event executes prior to beginning the generation phase.</p></li><li><p>beforeRender - The beforeRender event executes just prior to beginning the presentation phase.</p></li><li><p>initialize - A script that executes before the report begins to execute in both the generation or presentation phase.</p></li></ul><p>Within the initialize event you can define global functions, variables and objects. For example to create a global JavaScript function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                function gTest(v){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      return &quot;Global Function:&quot; + v;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                //this line is only required if using the function within Chart Scripts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reportContext.setPersistentGlobalVariable(&quot;gTest&quot;, gTest);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To use this function just call</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                gTest(&quot;MyTest&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                or</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                gTest = reportContext.getPersistentGlobalVariable(&quot;gTest&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                val = gTest(&quot;Use Persistent&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To access the reportContext object within a chart script use the following:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                context.getExternalContext().getScriptable()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To illustrate, the chart title could be altered with the following chart script:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                function beforeGeneration( chart, context ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    importPackage(Packages.org.eclipse.birt.chart.model.type.impl);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    newChartTitle = context.getExternalContext().getScriptable()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        .getPersistentGlobalVariable(&quot;testglobal&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    chart.getTitle().getLabel().getCaption().setValue(newChartTitle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the beforeFactory event there are several methods that allow accessing elements within the report. The elements usually require a name. For example, using a Data Set named &quot;orders&quot;, I want to display the query that was executed in a dynamic text element named &quot;TestHeader&quot;. This can be achieved by entering the following script in beforeFactory</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                query = this.getDataSet(&quot;orders&quot;).queryText</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getDynamicText(&quot;TestHeader&quot;).valueExpr = &quot;query;&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="report-element-events">Report Element Events<a aria-hidden="true" class="hash-link" href="#report-element-events" title="Direct link to heading">â€‹</a></h3><ul><li><p>onPrepare: This event gets called in the report generation phase. It is called once for each report element in the design. This is an opportunity to change the element design. The changes will affect all instances of the element, i.e. all table rows.</p></li><li><p>onCreate: Also a generation phase event. Here, the instance of the element can be modified and accessed. For example, an instance of a table row might be changed (setting every 10th rows background to red for example).</p></li><li><p>onRender: Presentation phase event. Similar to onCreate in that the instance is modifiable. Access to data is not available.</p></li></ul><p>Here is a very simple scripting example for a detail row in a table:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                onPrepare:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getStyle().backgroundColor = &quot;red&quot;;//This would change all row instances</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                onCreate:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if (this.getRowData().getExpressionValue(3) &gt; 100)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getStyle().backgroundColor=&quot;red&quot;;//This will only change the row instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                For a table with 100 rows, onPrepare will be called once (to change the </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                design), and onCreate and onRender will be called 100 times (to change the </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                instance).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="report-element-event-examples">Report Element Event Examples<a aria-hidden="true" class="hash-link" href="#report-element-event-examples" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="setting-label-text-dynamic-text-and-data-element-values">Setting Label, Text, Dynamic Text and Data Element values<a aria-hidden="true" class="hash-link" href="#setting-label-text-dynamic-text-and-data-element-values" title="Direct link to heading">â€‹</a></h4><p>Setting the value of a label element can be achieved by writting an event handler for the onPrepare or onCreate event and entering similar code presented below:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.text = &quot;My New Label&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Obviously this is a simple example and the value could be set simply by double clicking on the text element. Using the JavaScript editor allows complex logic to be implemented.
Setting the value of a text element can be done in the onPrepare event by entering the following code in your event handler:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.content= = &quot;My New Text&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When setting the value of a dynamic text element you will need to specify a value expression. This value expression gets evaluated when generating the report. Creating an event handler for the onPrepare event allows changing the value expression.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.valueExpr = &quot;row[&#x27;CITY&#x27;]&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>It is important to note that valueExpr expects a string. This is similar to what you would enter in the Expression Builder, but wrapped in quotes. So if you want to enter a string or partial string use single quotes.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.valueExpr = this.valueExpr = &quot;&#x27;my row count: &#x27; + (row[0] + 1)&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Setting values for data elements is accomplished by using the binding editor. If you wish to change this value in script you can set the value in the binding editor to a JavaScript variable. This variable can then be changed within script. If you use this method remember that order of execution is important. Changing the variable after the element is created will not change the data element value.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="setting-toc-entries-in-script">Setting TOC Entries in Script<a aria-hidden="true" class="hash-link" href="#setting-toc-entries-in-script" title="Direct link to heading">â€‹</a></h4><p>The TOC expression is similar to value expressions in that it expects a string.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.tocExpression=this.tocExpression = &quot;&#x27;tocbyrownumber: &#x27; + row[0]&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="using-row-data-within-scripts">Using row data within scripts<a aria-hidden="true" class="hash-link" href="#using-row-data-within-scripts" title="Direct link to heading">â€‹</a></h4><p>Row data is available in the onCreate event. This allows you to examine the values that will be used on the current row of a table or list.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getRowData().getExpressionValue(int) </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>should give you the value of the expression in the i:th column in your table.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getRowData().getExpressionValue(&quot;some_expression&quot;) </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>should give you the value of the provided expression for the row. This expression has to be defined on the table.</p><p>Examples:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Table(2 columns):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                row[&quot;product&quot;]    |    row[&quot;price&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Result:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                product1    |    $20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                product2    |    $30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Script on row.onCreate:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if (this.getRowData().getExpressionValue(1) == &quot;product1&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().backgroundColor = &quot;red&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if (this.getRowData().getExpressionValue(&quot;row[price]&quot;) == &quot;$30&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().backgroundColor = &quot;blue&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Result of script:</p><p>First row should be red, second row should be blue. Remember that the the expressions are the ones defined on the table using the binding editor, not the dataset. Using the row<!-- -->[name]<!-- --> syntax corresponds to the name field defined in the binding editor.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="modifying-hyperlinks">Modifying Hyperlinks<a aria-hidden="true" class="hash-link" href="#modifying-hyperlinks" title="Direct link to heading">â€‹</a></h4><p>The hyperlink for a data element can be modified in the onPrepare by using code similar to:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getAction().URI = &quot;&#x27;http://www.google.com&#x27;&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Notice the single quotes within the double quotes.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="using-getstyle">Using getStyle<a aria-hidden="true" class="hash-link" href="#using-getstyle" title="Direct link to heading">â€‹</a></h4><p><img alt="img" src="/birt-website/assets/images/getStyle-1f2e5f88db7e871474de74e67b309b13.jpg"></p><p>Using the getStyle method allows customizing properties for a given element.</p><p>for example to bold a particular element:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getStyle().fontWeight = &quot;bold&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="using-getparent">Using getParent<a aria-hidden="true" class="hash-link" href="#using-getparent" title="Direct link to heading">â€‹</a></h4><p>The getParent method allows access to elements that contain the element you are currently working with. If you were scripting an onPrepare event handler for a table row, getParent would return a handle to the table. If you were scripting an onPrepare event handler for a data element, to access the table you will need to call getParent several times.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getParent().getParent().getParent()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                This corresponds to </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                dataElement-&gt;Cell-&gt;Row-&gt;Table</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>So to change the color of the table background from a data element would look like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.getParent().getParent().getParent().getStyle().backgroundColor = &quot;Silver&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="using-getvalue">Using getValue<a aria-hidden="true" class="hash-link" href="#using-getvalue" title="Direct link to heading">â€‹</a></h4><p>Often it is required to alter the visual appearance of an element based on its value. This can be usually done within the mapping or highlights tab. When more complex logic is required it can be accomplished by using the getValue method within the onCreate of a row or data element.</p><p>On the data element</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if( this.getValue() &gt; 30 ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().fontFamily = &quot;Arial&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().backgroundColor = &quot;Yellow&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                on the row</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if (this.getRowData().getExpressionValue(&quot;row[QtyOrdered]&quot;) &gt; 30){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().fontFamily = &quot;Arial&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    this.getStyle().backgroundColor = &quot;Yellow&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="using-named-expressions">Using Named Expressions<a aria-hidden="true" class="hash-link" href="#using-named-expressions" title="Direct link to heading">â€‹</a></h4><p>A named expression is an expression that is created on an element and given a name. The expression definition can be edited in onPrepare, and the value of the evaluated expression can be accessed in onCreate and onRender. These are often useful when scripting in Java and use of a function like Total is needed. For example a named expression my be defined as totalCreditValue and it&#x27;s value set to Total.sum(row<!-- -->[&quot;CREDITLIMIT&quot;]<!-- -->). The named expression would then be available to other elements in JavaScript as well as Java.
So if you define a Named Expression on a table named &#x27;RWC&#x27; and set it&#x27;s value to row<!-- -->[0]<!-- -->, you would access it on the row like:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                rc = this.parent.getNamedExpressionValue(&quot;RWC&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="report-data-sourceset-events">Report Data Source(Set) Events<a aria-hidden="true" class="hash-link" href="#report-data-sourceset-events" title="Direct link to heading">â€‹</a></h3><p>The events available with Data Source and Data Sets will depend on the type of source that is being used.
Data Source Events
The common events for the Data Source are:</p><ul><li><p>afterClose - A script that executes after BIRT closes the data source connection.</p></li><li><p>afterOpen - A script that executes after BIRT opens the data source connection for data access.</p></li><li><p>beforeClose - A script that executes before BIRT closes the data source connection.</p></li><li><p>beforeOpen - A script that executes before BIRT opens the data source connection for data access.</p></li></ul><p>If you are building a Scripted Data Source, two additional events are available:</p><ul><li><p>Open - A script that executes to open the Data Source.</p></li><li><p>Close - A script that executes to close the Data Source.</p></li></ul><p>With the property binding editor now available, setting properties using script is not always necessary. An example of setting the password for the Data Source is as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Data Source beforeOpen </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                currentPassword = this.getExtensionProperty(&quot;odaPassword&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                DataSourceClass = new Packages.myExternalSecurity();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.setExtensionProperty(&quot;odaPassword&quot;, DataSourceClass.getPassword());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="data-set-events">Data Set Events<a aria-hidden="true" class="hash-link" href="#data-set-events" title="Direct link to heading">â€‹</a></h4><p>The common events for the Data Sets are:</p><ul><li><p>afterClose - A script that executes after BIRT closes the data set.</p></li><li><p>afterOpen - A script that executes after BIRT opens the data set.</p></li><li><p>beforeClose - A script that executes before BIRT closes the data set.</p></li><li><p>beforeOpen - A script that executes before BIRT opens the data set.</p></li><li><p>onFetch - A script that executes after fetching each row and before applying filters or calculating computed fields</p></li></ul><p>If you are building a Scripted Data Source, four additional events are available:</p><ul><li><p>describe - A script that is used to create the columns of a Scripted Data Source dynamically.</p></li><li><p>open - A script that executes upon opening the data set.</p></li><li><p>close - A script that executes after the fetch event returns false.</p></li><li><p>fetch - A script that executes to retrieve the data.</p></li></ul><p>With the property binding editor now available, setting Data Set properties can usually be done in the properites editor.
An example of changing the query with JavaScript is presented below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                beforeOpen of the Data Set</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                this.queryText = &quot;SELECT * FROM Customers where CustomerID </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     IN (&quot; + params[&quot;customersInClause&quot;] +&quot;)&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When implementing a Scripted Data Set, use the open event to initialize variables, classes etc. Use the Fetch event to load your row data. Remember to return false when your data set is finished. Use close to close any external objects.</p><p>To illustrate a Scripted Data Set, assume that you have an external Java Object that returns an ArrayList. To use this with the scripted data set do the following.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                open event of the Data Set</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                importPackage(Packages.test.my.ds)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myDataSet = new DS();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myArrayList = myDataSet.getList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                myIter = myArrayList.iterator();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                fetch event of the Data Set</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if( !myIter.hasNext() ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    return false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                //myOnlyColumn must be manually defined or defined in the describe event</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                row[&quot;myOnlyColumn&quot;] = iter.next();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="writting-events-in-java">Writting Events in Java<a aria-hidden="true" class="hash-link" href="#writting-events-in-java" title="Direct link to heading">â€‹</a></h3><p>BIRT event handlers can be written in Java. This section will describe setting up a Birt Events Java project, assigning the event handlers to elements and finally debugging the report.</p><p>When writing Java event handlers remember that a new event handler instance will be created for each invocation. The implication of this is that you can not use class data member to pass information between methods. For example, if you want to pass information from &quot;onPrepare()&quot; to &quot;onCreate()&quot;, you need to use the reportContext to hold the shared information.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="setting-up-the-java-project">Setting up the Java Project<a aria-hidden="true" class="hash-link" href="#setting-up-the-java-project" title="Direct link to heading">â€‹</a></h4><p>Within Eclipse, open your workspace that contains the reports that will use the Java event handlers. Create a new Java project and add scriptapi.jar from the Report Engine download.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="birt-pojo-runtime-note">Birt POJO Runtime Note:<a aria-hidden="true" class="hash-link" href="#birt-pojo-runtime-note" title="Direct link to heading">â€‹</a></h4><p>If you are using BIRT 3.7 or later See <a href="http://wiki.eclipse.org/Birt_3.7_Migration_Guide" target="_blank" rel="noopener noreferrer">BIRT 3.7 Migration Guide</a>.
Add org.eclipse.birt.runtime_version.jar to the project instead of scriptapi.jar.</p><p><img alt="img" src="/birt-website/assets/images/buildpath-59686d15ca391fb6a1b763717c670b1f.jpg"></p><p>The scriptapi.jar file includes the event adapters that are needed to implement event handlers.</p><p><img alt="img" src="/birt-website/assets/images/eventadapters-935fac22eb642781438eb13872bd746c.jpg"></p><p>Create a new class, specifying TableEventAdapter as the super class.</p><p><img alt="img" src="/birt-website/assets/images/tableadapter-9130013a61e94f8a58fcec5d4646ba53.jpg"></p><p>Enter the following code for the class.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                package my.test.events;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.eventadapter.TableEventAdapter;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.element.ITable;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.IReportContext;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public class TableEH extends TableEventAdapter {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     /* table onPrepare event */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     public void onPrepare( ITable table, IReportContext reportContext ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                table.setNamedExpression( &quot;total_limit_avg&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     &quot;Total.ave(row[\&quot;CREDITLIMIT\&quot;])&quot; );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            } catch ( Exception e ) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                e.printStackTrace( );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This code will add a named expression on a table. The value of the named expression is set to Total.ave(row<!-- -->[&quot;CREDITLIMIT&quot;]<!-- -->). In order for this to work there must be a column on the table with a value of row<!-- -->[&quot;CREDITLIMIT&quot;]<!-- -->.</p><p>Repeat the process above for the class RowEH which extends RowEventAdapter and enter the following code.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                package my.test.events;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.eventadapter.RowEventAdapter;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.IReportContext;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.instance.IRowInstance;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                import org.eclipse.birt.report.engine.api.script.IRowData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public class RowEH extends RowEventAdapter {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void onCreate(IRowInstance row, IReportContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        IRowData data = row.getRowData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        double avgCreditLimit = ((Double) row.getParent()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                             .getNamedExpressionValue(&quot;total_limit_avg&quot;)).doubleValue();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            if (((Double) data.getExpressionValue(&quot;row[\&quot;CREDITLIMIT\&quot;]&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 .doubleValue() &gt; avgCreditLimit ) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                row.getStyle( ).setFontWeight( &quot;bolder&quot; );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                row.getStyle( ).setFontSize( &quot;larger&quot; );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                row.getStyle( ).setColor( &quot;olive&quot; );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            e.printStackTrace();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This event handler is executed on every row and looks for a column named &quot;CREDITLIMIT&quot;. If this credit limit is above the average for all entries in the table, the font weight and size are changed and the color is changed to olive.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="adding-the-event-handler-to-the-report">Adding the event handler to the Report<a aria-hidden="true" class="hash-link" href="#adding-the-event-handler-to-the-report" title="Direct link to heading">â€‹</a></h4><p>Now that the Java classes are built we can create a simple report and apply the event handler.</p><p>Build a listing report using the sample database &quot;Classic Models&quot;. Enter the following query.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                select CLASSICMODELS.CUSTOMERS.CUSTOMERNUMBER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                CLASSICMODELS.CUSTOMERS.CUSTOMERNAME,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                CLASSICMODELS.CUSTOMERS.CREDITLIMIT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                from CLASSICMODELS.CUSTOMERS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Drag the data set to the report view and a table should be created automatically. Select the newly created table and enter my.test.events.TableEH in the Event Handler entry on the Properties tab.</p><p><img alt="img" src="/birt-website/assets/images/tableeh-8d571efe40a3968fc430c4fc63642b33.jpg"></p><p>Repeat the process for the row event handler, by selecting the row and entering my.test.events.RowEH in the Event Handler entry on the Properties tab.</p><p>Selecting Preview should result in the following output.</p><p><img alt="img" src="/birt-website/assets/images/scriptoutput-06645423bc98b946cff51bfb70a9cfec.jpg"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="debugging-a-report">Debugging a Report<a aria-hidden="true" class="hash-link" href="#debugging-a-report" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="debugging-java-event-handlers">Debugging Java Event Handlers<a aria-hidden="true" class="hash-link" href="#debugging-java-event-handlers" title="Direct link to heading">â€‹</a></h4><p>Switch to the Java Perspective and select the Java class that implements the event handler. Add breakpoints as usual and select the run-&gt;debug menu. Select BIRT Report under Configurations and click the new button. Check Java under debug type. Select the Classpath tab add the project that impements the event handler using the Add Projects button. Click on debug. The breakpoints in your code will halt report generation. You can now use the standard Eclipse Java Debugger features to diagnose your code.</p><p><img alt="img" src="/birt-website/assets/images/debugjava-549d4d1d2b879fca006eee671345451f.png"></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="debugging-javascript-event-handlers">Debugging JavaScript Event Handlers<a aria-hidden="true" class="hash-link" href="#debugging-javascript-event-handlers" title="Direct link to heading">â€‹</a></h4><p>If you are only using JavaScript event handlers the JavaScript debugger can be used to debug your report. Click Window-&gt;Open Perspective-&gt;Other and choose the debug Perspective. Once the debug Perspective is open select Run-&gt;Debug Configurations. You can create a new BIRT Report debug launch configuration that will use the currently opened report. In addition you specify which Report Engine Task to run while debugging. These include the Run, RunAndRender, and the RenderTask. You can also set the debugger to do a Run and then a Render Task. These options allow you to recreate the deployed environment. For example when using the frameset servlet mapping in the example Web Viewer, the engine performs a Run Task to generate the report document and then performs a Render Task on the report document. When debugging a report you can specify the Run+Render option to reproduce this behavior in the debugger. The debugger also includes breakpoints, expressions, and variables and supports stepping through either Java or JavaScript event handlers.</p><p><img alt="img" src="/birt-website/assets/images/debugjs-62a446d8b791cbf57a6e94010875b190.png"></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-java-event-handlers">Deploying Java Event Handlers<a aria-hidden="true" class="hash-link" href="#deploying-java-event-handlers" title="Direct link to heading">â€‹</a></h4><p>To deploy the Java Event Handlers you can place the jar containing the event handler in the SCRIPTLIB directory of the web application. The SCRIPTLIB directory is defined in the web.xml of the Viewer application. By default this directory is BIRTViewer/scriptlib. To change this directory set the BIRT_VIEWER_SCRIPTLIB_DIR entry in the web.xml.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;context-param&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &lt;param-name&gt;BIRT_VIEWER_SCRIPTLIB_DIR&lt;/param-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &lt;param-value&gt;&lt;/param-value&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &lt;/context-param&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="birt-pojo-viewer-note">BIRT POJO Viewer Note:<a aria-hidden="true" class="hash-link" href="#birt-pojo-viewer-note" title="Direct link to heading">â€‹</a></h4><p>If you are installing BIRT 3.7 or higher, the event handler jar can be placed in the WebViewer&#x27;s classpath (eg WEB-INF/lib).</p><p>If you are testing the event handler in the designer add the Java project that contains the event handler to the workspace which contains your BIRT report project. Use the Window-Preferences-Report Design-Classpath to configure the BIRT Project Classpath so it has access to the Java Project. Additionally you can select the report, click the properties tab, select the resources property and add the jar. When using this method import the jar to the BIRT Project workspace before adding the resource.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="additional-resources">Additional Resources<a aria-hidden="true" class="hash-link" href="#additional-resources" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://www.youtube.com/results?search_query=BIRT" target="_blank" rel="noopener noreferrer">YouTube</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/eclipse-birt/birt-website/tree/main/docs/integrating/scripting.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#events" class="table-of-contents__link toc-highlight">Events</a></li><li><a href="#generation-phase" class="table-of-contents__link toc-highlight">Generation phase.</a></li><li><a href="#presentation-phase" class="table-of-contents__link toc-highlight">Presentation phase.</a></li><li><a href="#reportcontext-and-this" class="table-of-contents__link toc-highlight">reportContext and <em>this</em></a></li><li><a href="#report-level-events" class="table-of-contents__link toc-highlight">Report Level Events</a></li><li><a href="#report-element-events" class="table-of-contents__link toc-highlight">Report Element Events</a></li><li><a href="#report-element-event-examples" class="table-of-contents__link toc-highlight">Report Element Event Examples</a></li><li><a href="#report-data-sourceset-events" class="table-of-contents__link toc-highlight">Report Data Source(Set) Events</a></li><li><a href="#writting-events-in-java" class="table-of-contents__link toc-highlight">Writting Events in Java</a></li><li><a href="#debugging-a-report" class="table-of-contents__link toc-highlight">Debugging a Report</a></li><li><a href="#additional-resources" class="table-of-contents__link toc-highlight">Additional Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">BIRT</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/birt-website/docs/t_brief-editor-tour">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/birt-website/docs/community">Community</a></li></ul></div><div class="col footer__col"><div class="footer__title">Eclipse</div><ul class="footer__items"><li class="footer__item"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Eclipse Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://www.eclipse.org/legal/privacy.php" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website terms of use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://www.eclipse.org/legal/copyright.php" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Copyright agent<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://www.eclipse.org/legal" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Legal<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/eclipse-birt/birt" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub BIRT<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/eclipse-birt/birt-website" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub BIRT website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Eclipse Foundation. All Rights Reserved.</div></div></div></footer></div>
<script src="/birt-website/assets/js/runtime~main.41b33e74.js"></script>
<script src="/birt-website/assets/js/main.34593de7.js"></script>
</body>
</html>