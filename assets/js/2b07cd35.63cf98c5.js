"use strict";(self.webpackChunkbirt_website=self.webpackChunkbirt_website||[]).push([[8236],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,h=c["".concat(l,".").concat(m)]||c[m]||d[m]||i;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1305:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return l},default:function(){return c},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return u}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],s={id:"reapi",title:"Report Engine API",sidebar_label:"Report Engine API"},l=void 0,p={unversionedId:"integrating/reapi",id:"integrating/reapi",isDocsHomePage:!1,title:"Report Engine API",description:"Background",source:"@site/docs/integrating/reapi.md",sourceDirName:"integrating",slug:"/integrating/reapi",permalink:"/birt-website/docs/integrating/reapi",editUrl:"https://github.com/eclipse-birt/birt-website/tree/main/docs/integrating/reapi.md",tags:[],version:"current",frontMatter:{id:"reapi",title:"Report Engine API",sidebar_label:"Report Engine API"},sidebar:"someSidebar",previous:{title:"Design Engine API",permalink:"/birt-website/docs/integrating/deapi"},next:{title:"Contributing to BIRT",permalink:"/birt-website/docs/how2contribute"}},u=[{value:"Background",id:"background",children:[],level:3},{value:"Installing the Engine",id:"installing-the-engine",children:[],level:3},{value:"Engine Source",id:"engine-source",children:[],level:3},{value:"Javadoc",id:"javadoc",children:[],level:3},{value:"Configuring JDBC Drivers",id:"configuring-jdbc-drivers",children:[{value:"Birt POJO Runtime Note:",id:"birt-pojo-runtime-note",children:[],level:4}],level:3},{value:"API Overview",id:"api-overview",children:[],level:3},{value:"EngineConfig",id:"engineconfig",children:[],level:3},{value:"ReportEngine",id:"reportengine",children:[],level:3},{value:"IReportRunnable",id:"ireportrunnable",children:[],level:3},{value:"IReportDocument",id:"ireportdocument",children:[],level:3},{value:"IEngineTask",id:"ienginetask",children:[],level:3},{value:"IDataExtractionTask",id:"idataextractiontask",children:[],level:3},{value:"IGetParameterDefinitionTask",id:"igetparameterdefinitiontask",children:[],level:3},{value:"IRenderTask",id:"irendertask",children:[],level:3},{value:"IRunTask",id:"iruntask",children:[],level:3},{value:"IRunAndRenderTask",id:"irunandrendertask",children:[],level:3},{value:"Miscellaneous",id:"miscellaneous",children:[{value:"Adding Script Objects",id:"adding-script-objects",children:[],level:4},{value:"Rendering to an Output Stream",id:"rendering-to-an-output-stream",children:[],level:4},{value:"IPlatformContext - Web Based Plugin Loading",id:"iplatformcontext---web-based-plugin-loading",children:[],level:4},{value:"Birt POJO Runtime Note:",id:"birt-pojo-runtime-note-1",children:[],level:4},{value:"Embedding Report Output",id:"embedding-report-output",children:[],level:4}],level:3},{value:"Emitter Configuration",id:"emitter-configuration",children:[],level:3}],d={toc:u};function c(e){var t=e.components,s=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"background"},"Background"),(0,i.kt)("p",null,"The BIRT Report Engine API (RE API) allows you to integrate the run-time part of BIRT into your application. This may mean integrating into a stand alone Java application, deploying as part of a servlet or embedding it within an RCP application. The engine supports the following operations:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Discover the set of parameters defined for a report.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Get the default values for parameters.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Run a report to produce HTML/Paginated HTML, WORD, XLS, PS, ODT, ODS, ODP or PDF output.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Fetch an image or chart for a report.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Export Report data to CSV")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Retrieve TOCs, Bookmarks, etc"))),(0,i.kt)("p",null,"The report engine supports extensions for custom report items, data access, and custom output formats. Extensions are discussed elsewhere. This section will focus on how your application integrates with the report engine."),(0,i.kt)("h3",{id:"installing-the-engine"},"Installing the Engine"),(0,i.kt)("p",null,"The first step is to download, install, and configure the BIRT engine. The engine is more than just a simple JAR file; it also includes a set of extensions (plug-ins), and a set of data drivers."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"First download the Report Engine from the ",(0,i.kt)("a",{parentName:"p",href:"https://download.eclipse.org/birt/updates/release/latest/"},"BIRT download site"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"This file will be named birt-runtime-version.zip.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Unzip this file into a directory, such as ",(0,i.kt)("em",{parentName:"p"},"c:\\birtruntime"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"When you set the Engine Home, which is explained later, use ",(0,i.kt)("em",{parentName:"p"},"C:/birtruntime/birt-runtime-version/ReportEngine")," as the value.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Add the jars in the ",(0,i.kt)("em",{parentName:"p"},"ReportEngine/lib")," directory to your ",(0,i.kt)("em",{parentName:"p"},"classpath/buildpath"),"."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note")," that if you are using the RE API within an RCP/Eclipse application these steps are not needed. Just add the RE API plugins to your application and call the needed functions."),(0,i.kt)("p",null,"The BIRT Viewer sample is also bundled with the Report Engine download. It is located under the WebViewerExample directory. If you decide to use this example, see ",(0,i.kt)("a",{parentName:"p",href:"/birt-website/docs/integrating/viewer-setup"},"Viewer Setup")," for an explanation. The Viewer uses the RE API to generate reports within the context of a servlet. It provides additional features, such as printing, TOCs, Page controls, etc. Before using the RE API, verify that the Viewer is not applicable to your application."),(0,i.kt)("h3",{id:"engine-source"},"Engine Source"),(0,i.kt)("p",null,"If you prefer to work directly with the BIRT source code, the Engine API is in the ",(0,i.kt)("em",{parentName:"p"},"org.eclipse.birt.report.engine")," project within ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/eclipse-birt/birt/tree/master/engine/org.eclipse.birt.report.engine"},"our Git repository"),". The source is also available from the BIRT site in one package (the BIRT Source Code Package), which can be downloaded from the ",(0,i.kt)("a",{parentName:"p",href:"https://download.eclipse.org/birt/updates/release/latest/"},"BIRT download site"),"."),(0,i.kt)("h3",{id:"javadoc"},"Javadoc"),(0,i.kt)("p",null,"This page provides an overview of the engine. To do actual development, consult the Engine Javadoc. These docs are available within BIRT Help."),(0,i.kt)("h3",{id:"configuring-jdbc-drivers"},"Configuring JDBC Drivers"),(0,i.kt)("p",null,"You must configure the engine to include any JDBC drivers that you need."),(0,i.kt)("h4",{id:"birt-pojo-runtime-note"},"Birt POJO Runtime Note:"),(0,i.kt)("p",null,"Add the driver jar to your classpath.\nTo do this, copy the driver jar file to the R",(0,i.kt)("em",{parentName:"p"},"eportEngineInstall/birt-runtime-version/ReportEngine/plugins/org.eclipse.birt.report.data.oda.jdbc_version/drivers")," Directory."),(0,i.kt)("h3",{id:"api-overview"},"API Overview"),(0,i.kt)("p",null,"The following are the key steps to use the API, identifying the classes and interfaces you use for each step."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create an instance of EngineConfig to set options for the report engine.")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Set the Engine Home and start the Platform (Loads the plug-ins). If you are using the RE API in plugin format there is no need to set BIRT Home. If you are using the RE API from within a servlet, be sure to read about PlatformServletContext later on this page.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Create an instance of the ReportEngine class. You can use this object to perform multiple tasks.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Open a report design using one of the openReport( ) methods of ReportEngine.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Obtain information about report parameters using IGetParameterDefinitionTask. This is only needed if you want to build a custom parameter page or collect parameter definition information. The IRunTask and the IRunAndRenderTask interfaces have methods for setting parameter values.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Run and render a report using IRunAndRenderReportTask or IRunTask and IRenderTask.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Repeat steps 4-6 for the next report.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"When done, call shutdown( ) on your engine instance. If using the engine in a servlet shudown the engine when the servlet shuts down."))),(0,i.kt)("p",null,"The following sections describe the primary Engine classes in detail. The Engine API includes a number of secondary helper classes referenced within each description. The diagram below, serves as an overview of the classes needed to accomplish a given task."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"img",src:n(5227).Z})),(0,i.kt)("h3",{id:"engineconfig"},"EngineConfig"),(0,i.kt)("p",null,"Use the EngineConfig class to set global options for the report engine as a whole. Use it to specify the location of engine plug-ins, the location of data drivers, and to add application-wide scriptable objects."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'                EngineConfig config = new EngineConfig( );\n                config.setEngineHome( "put engine path here" );\n                \n')),(0,i.kt)("p",null,"The engine home should be set to installedlocation/birt-runtime-version/ReportEngine when deployed as a stand alone Java Application. See the wiki examples for Servlet and RCP deployment."),(0,i.kt)("p",null,"Other functions of interest within this class are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"setLogConfig(String directoryName, Level level)\nThis call sets the Log directory name and level (OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST and ALL)\nSetting directoryName to null will log to stdout.")),(0,i.kt)("h3",{id:"reportengine"},"ReportEngine"),(0,i.kt)("p",null,"The ReportEngine class represents the BIRT Report Engine. There is a significant cost associated with creating an engine instance, due primarily to the cost of loading extensions. Therefore, each application should create just one ReportEngine instance and use it to run multiple reports. This is important to remember when deploying the engine in a servlet as well."),(0,i.kt)("p",null,"The report engine is created through a factory supplied by the Platform. Before creating the engine, you should start the Platform, which will load the appropriate plug-ins. This is done by calling Platform.startup(config) that takes an EngineConfig object as argument. After using the engine, call Plaform.shutdown() function to do clean up work, which includes unloading the extensions. When shutting down the engine in some environments, it may also be required to call:\nRegistryProviderFactory.releaseDefault();"),(0,i.kt)("p",null,"This should be added after the Platform.shutdown() method is called. You will need to import the org.eclipse.core.internal.registry.RegistryProviderFactory package. See ",(0,i.kt)("a",{parentName:"p",href:"https://bugs.eclipse.org/bugs/show_bug.cgi?id=351052"},"Bugzilla 351052")," for more details."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'try{\nfinal config = new EngineConfig( );\n    //delete the following line if using BIRT 3.7 (or later) POJO runtime\n    //As of 3.7.2, BIRT now provides an OSGi and a POJO Runtime.\n\n    config.setEngineHome( "C:\\\\birt-runtime-2_6_2\\\\birt-runtime-2_6_2\\\\ReportEngine" );\n    config.setLogConfig(c:/temp, Level.FINE);\n\n    Platform.startup( config );\n    //If using RE API in Eclipse/RCP application this is not needed.\n    IReportEngineFactory factory = (IReportEngineFactory) Platform\n            .createFactoryObject( IReportEngineFactory.EXTENSION_REPORT_ENGINE_FACTORY );\n    IReportEngine engine = factory.createReportEngine( config );\n    engine.changeLogLevel( Level.WARNING );\n}catch( Exception ex){\n    ex.printStackTrace();\n}\n// Run reports, etc.\n...\n\n// destroy the engine.\ntry\n{\n    engine.destroy();\n    Platform.shutdown();\n    //Bugzilla 351052\n    RegistryProviderFactory.releaseDefault();\n}catch ( EngineException e1 ){\n    // Ignore\n}\n')),(0,i.kt)("p",null,"Other functions of interest within this class are:"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"engine.changeLogLevel(java.util.logging.Level.FINE);")),(0,i.kt)("p",null,"Change engine log level (OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST and ALL)"),(0,i.kt)("h3",{id:"ireportrunnable"},"IReportRunnable"),(0,i.kt)("p",null,"BIRT report designs are stored as XML files. By default the extension is rptdesign.\nTo work with the report design in the engine, you must first load the report using one of the openDesign( ) methods in the ReportEngine class."),(0,i.kt)("p",null,"The report design open methods returns a IReportRunnable instance that represents the engine's view of the report design."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    IReportRunnable report = engine.openReportDesign( name );\n                \n")),(0,i.kt)("p",null,"Note that BIRT supplies many options for opening reports such as the filename or an input stream. Use the returned object to obtain parameter data or run the report.\nThe class provides methods for getting report properties such as the title, author and so on. It also provides methods for getting images embedded (stored) within the report design. If your application requires more information about the design, you can obtain a Design Engine report handle, then use the ",(0,i.kt)("a",{parentName:"p",href:"/birt-website/docs/integrating/deapi"},"BIRT Design Engine API")," to traverse the report design."),(0,i.kt)("h3",{id:"ireportdocument"},"IReportDocument"),(0,i.kt)("p",null,"BIRT optionally can store reports in an intermediate format, after generation and before rendering. This document, with the default extension rptdocument, can be manipulated with the IReportDocument interface. The Engine will create this document when the runTask is used. The BIRT viewer uses this format to do pagination, TOCs, CSV extraction, bookmarks, etc. When finished with a IReportDocument, be sure to close it, with the close() method."),(0,i.kt)("p",null,"The Engine's openDocument method returns a IReportDocument that represents the intermediate report document."),(0,i.kt)("p",null,"The example below illustrates getting the TOC from the report document, after the runTask is used to generate the report."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'IReportDocument ird = engine.openReportDocument("c:/work/test/TOCTest.rptdocument");\n//get root node\nTOCNode td = ird.findTOC(null);\nList children = td.getChildren( );\n//Loop through Top Level Children\nif ( children != null && children.size( ) > 0 ){\n    for ( int i = 0; i < children.size( ); i++ ){\n        TOCNode child = ( TOCNode ) children.get( i );\n        System.out.println( "Node ID " + child.getNodeID());\n        System.out.println( "Node Display String " + child.getDisplayString());\n        System.out.println( "Node Bookmark " + child.getBookmark());\n    }\n}\n                \n')),(0,i.kt)("h3",{id:"ienginetask"},"IEngineTask"),(0,i.kt)("p",null,"BIRT reports support scripting. Operations that execute scripts require a scripting context. Report operations also require a locale. BIRT Engine tasks provide the framework for managing the scripting context, report locales and so on. In general, if an operation requires neither a script context nor a locale, it will appear as a method on the engine or the report design. However, if the operation does require these items, then a task class represents the operation."),(0,i.kt)("p",null,"For example, opening a design file or retrieving an image in the design file does not require setting up a scripting context. Other operations, such as retrieving default parameters, retrieving a dynamic selection list, and running and rendering a report, all support scripting, require a scripting context, and are represented as tasks."),(0,i.kt)("p",null,"Create tasks using the factory methods on the ReportEngine class. The supported Tasks are shown below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"engine.createDataExtractionTask();")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"engine.createGetParameterDefinitionTask();")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"engine.createRenderTask();")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"engine.createRunTask();")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"engine.createRunAndRenderTask();"))),(0,i.kt)("h3",{id:"idataextractiontask"},"IDataExtractionTask"),(0,i.kt)("p",null,"Use this task to extract data from a report document. The BIRT viewer uses this class to extract report data into CSV format. This class supports extracting data from the report document by specifying the result set and columns you would like to have extracted.\nFrom the Viewer code"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"dataTask.selectResultSet( resultSetName );\ndataTask.selectColumns( columnNames );\ndataTask.setLocale( locale );\n                \n")),(0,i.kt)("p",null,"Below is an example that uses the Data Extraction Task to extract the first two columns of data."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'//Open previously created report document\nIReportDocument iReportDocument = engine\n     .openReportDocument("c:/work/test/TOCTest.rptdocument");\n\n//Create Data Extraction Task       \nIDataExtractionTask iDataExtract = engine.createDataExtractionTask(iReportDocument);\n        \n//Get list of result sets       \nArrayList resultSetList = (ArrayList)iDataExtract.getResultSetList( );\n                \n//Choose first result set\nIResultSetItem resultItem = (IResultSetItem)resultSetList.get( 0 );\nString dispName = resultItem.getResultSetName( );\niDataExtract.selectResultSet( dispName );\n                \nIExtractionResults iExtractResults = iDataExtract.extract();\nIDataIterator iData = null;\ntry{\n    if ( iExtractResults != null ){\n        iData = iExtractResults.nextResultIterator( );\n        //iterate through the results\n        if ( iData != null  ){\n            while ( iData.next( ) ){    \n                Object objColumn1;\n                Object objColumn2;\n                try{\n                    objColumn1 = iData.getValue(0);\n                }catch(DataException e){\n                    objColumn1 = new String("");\n                }\n                try{\n                    objColumn2 = iData.getValue(1);\n                }catch(DataException e){\n                    objColumn2 = new String("");\n                }\n                System.out.println( objColumn1 + " , " + objColumn2 );\n            }\n            iData.close();\n        }\n    }\n}catch( Exception e){\n        e.printStackTrace();\n}\n\niDataExtract.close();\n                \n')),(0,i.kt)("h3",{id:"igetparameterdefinitiontask"},"IGetParameterDefinitionTask"),(0,i.kt)("p",null,"Use this task to obtain information about parameters. Parameter default values are expressions, and so a scripting context (represented by the task) is required. Parameter definitions provide access to the parameter definition information that the report designer entered at design time. If a parameter has custom XML or user-defined properties defined, then these are also available. Parameters can be organized into groups. Your application has the choice of retrieving the parameters organized by group (as they should be displayed to the user), or in ungrouped form (useful for creating a programmatic interface.)"),(0,i.kt)("p",null,"The ",(0,i.kt)("em",{parentName:"p"},"IParameterGroupDefn")," and ",(0,i.kt)("em",{parentName:"p"},"IScalarParameterDefn")," interfaces provide information about parameter groups and individual parameters."),(0,i.kt)("p",null,"The following example opens a report design and iterates through the parameters and parameter groups. If a List Box parameter is found, which is not in a group, the selection values are retrieved."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'// Open a report design\nIReportRunnable design = engine.openReportDesign("C:/work/test/parameters.rptdesign");\n\nIGetParameterDefinitionTask task = engine.createGetParameterDefinitionTask(design);\nCollection params = task.getParameterDefns(true);\n\nIterator iter = params.iterator( );\n// Iterate over all parameters\nwhile(iter.hasNext())\n{\n    IParameterDefnBase param = (IParameterDefnBase) iter.next();\n    // Group section found\n    if (param instanceof IParameterGroupDefn) {\n        // Get Group Name\n        IParameterGroupDefn group = (IParameterGroupDefn) param;\n        System.out.println("Parameter Group: " + group.getName());\n        // Get the parameters within a group\n        Iterator i2 = group.getContents().iterator();\n        while (i2.hasNext()) {\n            IScalarParameterDefn scalar = (IScalarParameterDefn) i2.next();\n            System.out.println("\\t" + scalar.getName());\n        }\n    } else {\n        // Parameters are not in a group\n        IScalarParameterDefn scalar = (IScalarParameterDefn) param;\n        System.out.println(param.getName());\n        // Parameter is a List Box\n        if (scalar.getControlType() == IScalarParameterDefn.LIST_BOX) {\n            Collection selectionList = task.getSelectionList(param.getName());\n            // Selection contains data\n            if (selectionList != null) {\n                for (Iterator sliter = selectionList.iterator(); sliter.hasNext();) {\n                    // Print out the selection choices\n                    IParameterSelectionChoice selectionItem = (IParameterSelectionChoice) sliter.next();\n                    String value = (String) selectionItem.getValue();\n                    String label = selectionItem.getLabel();\n                    System.out.println(label + "--" + value);\n                }\n            }\n        }\n    }\n}\n\ntask.close();\n                \n')),(0,i.kt)("p",null,"Use the ",(0,i.kt)("em",{parentName:"p"},"IGetParameterDefinitionTask")," class to evaluate the default value for a parameter. The parameter default value is an expression, and the task provides the required execution context."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"IScalarParameterDefn param = ...;\nIGetParameterDefinitionTask task = ...;\nObject value = task.getDefaultValue(param);\n")),(0,i.kt)("h3",{id:"irendertask"},"IRenderTask"),(0,i.kt)("p",null,"Use this task to render a report document to a specific output (eg, HTML, PDF, ...). This task expects the document to exist, which means it has been generated with the RunTask engine task. This class renders the report, based on the supplied page range, page number or all if no page is specified."),(0,i.kt)("p",null,'The following example renders the first two pages of the "Pages" report document. You will notice that it renders the two pages as one page of HTML.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'//Open a report document \nIReportDocument iReportDocument = engine.openReportDocument("c:/work/test/Pages.rptdocument");\n//Create Render Task\nIRenderTask task = engine.createRenderTask(iReportDocument);\n//Set parent classloader report engine\ntask.getAppContext().put(EngineConstants.APPCONTEXT_CLASSLOADER_KEY, \n     RenderTaskExample.class.getClassLoader()); \nIRenderOption options = new RenderOption();     \noptions.setOutputFormat("html");\noptions.setOutputFileName("output/resample/eventorder.html");\nif( options.getOutputFormat().equalsIgnoreCase("html")){\n    HTMLRenderOption htmlOptions = new HTMLRenderOption( options);\n    htmlOptions.setImageDirectory("output/image");\n    htmlOptions.setHtmlPagination(false);\n    //set this if you want your image source url to be altered\n    //If using the setBaseImageURL, make sure\n    //to set image handler to HTMLServerImageHandler\n    htmlOptions.setBaseImageURL("http://myhost/prependme?image=");\n    htmlOptions.setHtmlRtLFlag(false);\n    htmlOptions.setEmbeddable(false);\n}else if( options.getOutputFormat().equalsIgnoreCase("pdf") ){\n    PDFRenderOption pdfOptions = new PDFRenderOption( options );\n    pdfOptions.setOption( IPDFRenderOption.FIT_TO_PAGE, new Boolean(true) );\n    pdfOptions.setOption( IPDFRenderOption.PAGEBREAK_PAGINATION_ONLY, new Boolean(true) );\n}\n//Use this method if you want to provide your own action handler\noptions.setActionHandler(new MyActionHandler());\n//file based images\n//options.setImageHandler(new HTMLCompleteImageHandler())\n//Web based images.  Allows setBaseImageURL to prepend to img src tag\noptions.setImageHandler(new HTMLServerImageHandler());\nIRenderTask task = engine.createRenderTask(document);       \ntask.setRenderOption(options);\ntask.setPageRange("1-2");\ntask.render();\niReportDocument.close();\n                \n')),(0,i.kt)("h3",{id:"iruntask"},"IRunTask"),(0,i.kt)("p",null,"Use this task to run a report and generate a report document, which is saved to disk. The report document can then be used with the ",(0,i.kt)("em",{parentName:"p"},"IRenderTask")," to support features such as paging."),(0,i.kt)("p",null,"The following example simply creates a report document and saves it to disk."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'//Open a report design \nIReportRunnable design = engine.openReportDesign("C:/work/test/MyOrders.rptdesign");\n \n//Create task to run the report - use the task to execute the report and save to disk.\nIRunTask task = engine.createRunTask(design); \n\n//Set parent classloader for engine\ntask.getAppContext().put(EngineConstants.APPCONTEXT_CLASSLOADER_KEY, \n     RunTaskExample.class.getClassLoader()); \n     \n//run the report and destroy the engine\ntask.run("c:/work/test/MyOrders.rptdocument");      \ntask.close();\n                \n')),(0,i.kt)("h3",{id:"irunandrendertask"},"IRunAndRenderTask"),(0,i.kt)("p",null,"Use this task to run a report and output it to one of the supported output formats. This task does not create a report document. Create a new task for each report that you run."),(0,i.kt)("p",null,"Reports may take parameters. The ",(0,i.kt)("em",{parentName:"p"},"IRunAndRenderReportTask")," takes parameter values as a HashMap or you can set them individually. The ",(0,i.kt)("em",{parentName:"p"},"IRunAndRenderReportTask")," provides the ",(0,i.kt)("em",{parentName:"p"},"validateParameters(...)")," method to validate the parameter values before you run the report."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'//Open the report design\nReportRunnable design = engine.openReportDesign("Reports/TopNPercent.rptdesign"); \n\n//Create task to run and render the report,\nIRunAndRenderTask task = engine.createRunAndRenderTask(design);\n\n//Set parent classloader for engine\ntask.getAppContext().put(EngineConstants.APPCONTEXT_CLASSLOADER_KEY, \n     RunAndRenderTaskExample.class.getClassLoader()); \n\n//Set parameter values and validate\ntask.setParameterValue("Top Percentage", (new Integer(3)));\ntask.setParameterValue("Top Count", (new Integer(5)));\ntask.validateParameters();\n\n//Setup rendering to HTML\nHTMLRenderOption options = new HTMLRenderOption();      \noptions.setOutputFileName("output/resample/TopNPercent.html");\noptions.setOutputFormat("html");\n\n//Setting this to true removes html and body tags\noptions.setEmbeddable(false);\ntask.setRenderOption(options);\n//run and render report\ntask.run();\ntask.close();\n                \n')),(0,i.kt)("h3",{id:"miscellaneous"},"Miscellaneous"),(0,i.kt)("p",null,"Described below are some miscellaneous items that bear mentioning when using the BIRT Report Engine API"),(0,i.kt)("h4",{id:"adding-script-objects"},"Adding Script Objects"),(0,i.kt)("p",null,"BIRT's script engine supports adding Java objects at the API level. If you wish the Java object to be available to the Report, retrieve the application context at the EngineConfig or Task level and add the object to the Map. For example, adding a Java object to the task."),(0,i.kt)("p",null,"Add the following code to your task."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'MyJavaObject jo = new MyJavaObject();\ntask.getAppContext().put("MyJavaScriptItem", jo);\n                \n')),(0,i.kt)("p",null,"Now within the the script editor, you can reference your Java Object as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"testMyJavaObject = MyJavaScriptItem.getMyMethod();\n                \n")),(0,i.kt)("h4",{id:"rendering-to-an-output-stream"},"Rendering to an Output Stream"),(0,i.kt)("p",null,"When rendering a report it may be desirable to output the report to an output stream, such as ",(0,i.kt)("em",{parentName:"p"},"HttpServletResponse"),". To do this modify your RenderOption instance to use ",(0,i.kt)("em",{parentName:"p"},"setOutputStream")," instead of ",(0,i.kt)("em",{parentName:"p"},"setOutputFileName"),". For example,"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"public void webReport( HttpServletResponse response ){\n.\n.\n.\n//Set rendering options \nHTMLRenderOption options = new HTMLRenderOption();\noptions.setOutputStream(response);\ntask.setRenderOption(options);      \n//run the report\ntask.run();\n}\n                \n")),(0,i.kt)("h4",{id:"iplatformcontext---web-based-plugin-loading"},"IPlatformContext - Web Based Plugin Loading"),(0,i.kt)("h4",{id:"birt-pojo-runtime-note-1"},"Birt POJO Runtime Note:"),(0,i.kt)("p",null,"This section can be ignored if your are installing BIRT 3.7 or later. Just add the BIRT plugins to the Web Application classpath."),(0,i.kt)("p",null,"By default BIRT loads plug-ins located in the BIRT_HOME/plugins directory. The plug-ins loaded provide functionality for connecting to data sources, emitters (eg, PDF, WORD, XLS, HTML ...), and chart rendering. BIRT_HOME in the examples on this page is set using the setEngineHome method of the EngineConfig class. BIRT loads these plug-ins using the Java File API."),(0,i.kt)("p",null,"This method is usually sufficient. If deployed to a web application, the developer can usually call ServletContext.getRealPath to retrieve the real path and set the BIRT_HOME accordingly. This can present a problem when deploying to a war file. Certain application servers will return null when getRealPath is called. This will result in the plug-ins not getting loaded."),(0,i.kt)("p",null,"The IPlatformContext interface describes the methods needed to load the resources required by the BIRT runtime. Within BIRT there are two implementations of this interface, PlatformFileContext() and PlatformServletContext(). The Platform Context is set using the setEngineContext method of the EngineConfig class. If this method is not called it defaults to PlaformFileContext() and uses the Java File API to load the resources. The PlatformServletContext class uses Resource based operations. So if you are deploying an application to the Web that uses the BIRT API and it is not contained in a war you can use the default and set your engine home to something similar to:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'config.setEngineHome( servletContext.getRealPath("/WEB-INF"));\n                \n')),(0,i.kt)("p",null,"The BIRT Viewer application will load the plug-ins from /WEB-INF/Plugins directory. If you deploy your application in a war, setup your code like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'//this causes the plug-in loader to look in the current directory.\nconfig.setEngineHome("");\n            \n//Using the PlatformServletContext will cause the OSGi loader to look for the\n//plug-ins in the WEB-INF/Platform directory.  If this directory\n//does not exist create it. \n//Next copy the plug-ins directory from the ReportEngine directory to\n//the WEB-INF/Platform/ directory.\nIPlatformContext context = new PlatformServletContext( sc );\nconfig.setPlatformContext( context );\n                \n')),(0,i.kt)("h4",{id:"embedding-report-output"},"Embedding Report Output"),(0,i.kt)("p",null,"If you need to embed your report output into an existing web page you can use the ",(0,i.kt)("em",{parentName:"p"},"options.setEmbeddable(true);")," method. This will remove the \\<HTML",">"," and \\<BODY",">"," tags in the generated report. For example,"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"public void embedReport( HttpServletResponse response ){\n.\n.\n.\n//Set rendering options \nHTMLRenderOption options = new HTMLRenderOption();\noptions.setOutputStream(response);\noptions.setEmbeddable(true);\ntask.setRenderOption(options);      \n                \n//run the report\ntask.run();\n}\n                \n")),(0,i.kt)("h3",{id:"emitter-configuration"},"Emitter Configuration"),(0,i.kt)("p",null,'An "emitter" is the component of the report engine that produces output. BIRT provides many emitters such as HTML, XLS and PDF. To configure emitter options you need to use the RenderOption class. In some of the examples above this was done, with code similar to the following:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'IRenderOption options = new RenderOption();     \noptions.setOutputFormat("html");\noptions.setOutputFileName("output/resample/eventorder.html");\n                \n')),(0,i.kt)("p",null,"BIRT also provides an extended RenderOption class for the PDF and HTML emitters (PDFRenderOption and HTMLRenderOption). The PDFRenderOption class provides methods for handling fonts and the HTMLRenderOption class provides methods for handling images, url encoding, and other html specific settings. You may need to configure the HTML emitter to manage images.\nBIRT supports several image types:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Images referenced using a URL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Embedded images")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Images created to represent charts")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Images from BLOB types"))),(0,i.kt)("p",null,"Your application must have a policy for handling images in HTML. URL-based images are usually no problem. However, you'll need to handle the others. The ",(0,i.kt)("em",{parentName:"p"},"IHTMLImageHandler")," interface defines the policy. The BIRT Engine provides two default implementations:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"HTMLCompleteImageHandler"),": used to write images to disk when rendering a report to produce an HTML file on disk.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"HTMLServerImageHandler"),": used to handle images for an engine running in an app server. This class is used by the BIRT example web viewer."))),(0,i.kt)("p",null,"When you instantiate a ",(0,i.kt)("em",{parentName:"p"},"EngineConfig")," class the ",(0,i.kt)("em",{parentName:"p"},"HTMLCompleteImageHandler")," class is used by default. Images will be created in your temporary files location (ie C:\\Documents and Settings\\User\\Local Settings\\Temp). If this is not desired you can use the HTMLRenderOption class to change this location."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'HTMLRenderOption htmlOptions = new HTMLRenderOption( options);\nhtmlOptions.setImageDirectory("output/image");\n                \n')),(0,i.kt)("p",null,"Setting the Image Directory instructs the RE API to store images, used within the report output, in that directory. If your emitter is setup with the standard ",(0,i.kt)("em",{parentName:"p"},"HTMLCompleteImageHandler"),", the output image src attribute will point to this directory using the File protocol. If your emitter is configured with the ",(0,i.kt)("em",{parentName:"p"},"HTMLServerImageHandler"),", you can specify an image base URL using the ",(0,i.kt)("em",{parentName:"p"},"HTMLRenderOption")," class. The engine will prepend all images with this URL in the src attribute of the report output."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'HTMLRenderOption options = new HTMLRenderOption();      \noptions.setOutputFileName("output/resample/TopNPercent.html");\noptions.setOutputFormat("html");\noptions.setImageDirectory("C:\\\\apps\\\\apache-tomcat-5.5.20\\\\webapps\\\\2.2\\\\images");\noptions.setBaseImageURL("http://localhost:8080/2.2/images/");       \noptions.setImageHandler(new HTMLServerImageHandler());\ntask.setRenderOption(options);\n                \n')),(0,i.kt)("p",null,"You can also create your own implementation of ",(0,i.kt)("em",{parentName:"p"},"IHTMLImageHandler")," if the above don't meet your needs."),(0,i.kt)("p",null,"If your code is going to be run in a servlet, please review the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/eclipse-birt/birt/tree/master/viewer/org.eclipse.birt.report.viewer/birt/WEB-INF/classes/org/eclipse/birt/report/service"},"ReportEngineService.java")," code in Git. The BIRT Viewer uses this class to configure the engine. The constructor for the ",(0,i.kt)("em",{parentName:"p"},"ReportEngineService")," uses the ",(0,i.kt)("em",{parentName:"p"},"HTMLServerImageHandler")," class, which in turn reads Image locations from the web.xml file."))}c.isMDXComponent=!0},5227:function(e,t,n){t.Z=n.p+"assets/images/retask-1b799fa7811eacc5f3554a3c9e3dfaad.jpg"}}]);